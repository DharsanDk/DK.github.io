<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dharsan Kumar P | AI-Driven Business & Data Analytics Portfolio</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  
  <!-- Enhanced Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts-gl@2.0.9/dist/echarts-gl.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  
  <style>
    :root {
      --bg: #f8f9fa;
      --text: #212529;
      --header: linear-gradient(135deg, #0a1f44 0%, #1a3a6a 50%, #2a5a8f 100%);
      --section-title: #343a40;
      --primary: #0a1f44;
      --secondary: #2a5a8f;
      --accent: #4b8fe2;
      --card-bg: #ffffff;
      --shadow: 0 4px 20px rgba(0,0,0,0.1);
      --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      --glass: rgba(255, 255, 255, 0.15);
      --glass-border: rgba(255, 255, 255, 0.25);
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
    }
    
    [data-theme="dark"] {
      --bg: #121212;
      --text: #f1f1f1;
      --header: linear-gradient(135deg, #0a0e17 0%, #1a2435 50%, #2a3a54 100%);
      --section-title: #f8f8f8;
      --primary: #4facfe;
      --secondary: #00f2fe;
      --accent: #6c8cff;
      --card-bg: #1e1e1e;
      --shadow: 0 4px 20px rgba(0,0,0,0.3);
      --glass: rgba(30, 30, 30, 0.4);
      --glass-border: rgba(255, 255, 255, 0.15);
      --success: #5cb85c;
      --warning: #f0ad4e;
      --danger: #d9534f;
    }
    
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      animation: fadeIn 1s ease-in;
      transition: var(--transition);
      line-height: 1.7;
      overflow-x: hidden;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    #vanta-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    
    /* Glass Morphism Elements */
    .glass-card {
      background: var(--glass);
      border-radius: 16px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
      padding: 25px;
    }
    
    /* AI Dashboard Styles */
    .ai-dashboard {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 30px;
      min-height: 100vh;
    }
    
    .ai-sidebar {
      background: var(--glass);
      backdrop-filter: blur(12px);
      padding: 30px 20px;
      border-right: 1px solid var(--glass-border);
    }
    
    .ai-main {
      padding: 30px;
    }
    
    /* Data Upload Section */
    .data-upload {
      margin-bottom: 30px;
      text-align: center;
    }
    
    .upload-area {
      border: 2px dashed var(--glass-border);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .upload-area:hover {
      border-color: var(--accent);
      background: rgba(74, 144, 226, 0.1);
    }
    
    .upload-area i {
      font-size: 48px;
      color: var(--accent);
      margin-bottom: 15px;
    }
    
    /* AI Visualization Container */
    .ai-visualization {
      width: 100%;
      height: 500px;
      background: var(--glass);
      border-radius: 16px;
      padding: 20px;
      margin: 40px 0;
      position: relative;
      overflow: hidden;
    }
    
    /* AI Assistant Section */
    .ai-assistant {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 1000;
    }
    
    .ai-assistant-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      transition: var(--transition);
      border: none;
    }
    
    .ai-assistant-btn:hover {
      transform: scale(1.1) rotate(15deg);
    }
    
    .ai-assistant-chat {
      position: absolute;
      bottom: 80px;
      right: 0;
      width: 400px;
      height: 600px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.2);
      overflow: hidden;
      display: none;
      flex-direction: column;
      border: 1px solid var(--glass-border);
    }
    
    .ai-assistant-chat.active {
      display: flex;
    }
    
    .ai-assistant-header {
      padding: 15px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .ai-assistant-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
    }
    
    .ai-message {
      margin-bottom: 15px;
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      line-height: 1.4;
    }
    
    .ai-message-bot {
      background: var(--glass);
      border-radius: 18px 18px 18px 4px;
      align-self: flex-start;
    }
    
    .ai-message-user {
      background: var(--accent);
      color: white;
      border-radius: 18px 18px 4px 18px;
      align-self: flex-end;
    }
    
    .ai-assistant-input {
      padding: 15px;
      display: flex;
      gap: 10px;
      border-top: 1px solid var(--glass-border);
    }
    
    .ai-assistant-input input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 20px;
      border: 1px solid var(--glass-border);
      background: var(--glass);
      color: var(--text);
    }
    
    .ai-assistant-input button {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .ai-assistant-input button:hover {
      background: var(--primary);
    }
    
    /* Dashboard Section */
    .dashboard-section {
      padding: 80px 0;
      background: linear-gradient(135deg, rgba(10,31,68,0.1) 0%, rgba(42,90,143,0.1) 100%);
    }
    
    .dashboard-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .dashboard-header {
      text-align: center;
      margin-bottom: 60px;
    }
    
    .dashboard-header h2 {
      font-size: 2.8rem;
      color: var(--primary);
      margin-bottom: 20px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .dashboard-header p {
      max-width: 700px;
      margin: 0 auto;
      font-size: 1.1rem;
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
      gap: 40px;
    }
    
    .dashboard-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 30px;
      box-shadow: var(--shadow);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }
    
    .dashboard-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
    }
    
    .dashboard-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    .dashboard-card h3 {
      color: var(--primary);
      margin-bottom: 20px;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .dashboard-card h3 i {
      color: var(--accent);
    }
    
    .chart-container {
      width: 100%;
      height: 400px;
    }
    
    .kpi-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .kpi-card {
      background: var(--glass);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
      transition: var(--transition);
    }
    
    .kpi-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .kpi-value {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 5px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .kpi-label {
      font-size: 1rem;
      color: var(--text);
      opacity: 0.8;
    }
    
    .dashboard-controls {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      align-items: center;
    }
    
    .time-filter {
      display: flex;
      gap: 10px;
    }
    
    .time-filter button {
      padding: 8px 15px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      color: var(--text);
      border-radius: 20px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .time-filter button.active {
      background: var(--primary);
      color: white;
    }
    
    .dashboard-export {
      display: flex;
      gap: 15px;
    }
    
    .dashboard-export button {
      padding: 8px 20px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      color: var(--text);
      border-radius: 20px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .dashboard-export button:hover {
      background: var(--primary);
      color: white;
    }
    
    /* Header Styles */
    header {
      color: #fff;
      padding: 150px 20px 100px;
      text-align: center;
      position: relative;
      overflow: hidden;
      animation: slideDown 1s ease-in-out;
      background: var(--header);
    }
    
    .header-content {
      max-width: 900px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    
    header h1 {
      margin: 0;
      font-size: 4rem;
      font-weight: 700;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      font-family: 'Montserrat', sans-serif;
    }
    
    .title-3d {
      display: inline-block;
      transform-style: preserve-3d;
      animation: float3d 6s ease-in-out infinite;
      text-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    /* Professional Social Links */
    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }
    
    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 24px;
      transition: var(--transition);
    }
    
    .social-link:hover {
      background: var(--accent);
      transform: translateY(-5px);
    }
    
    /* Responsive adjustments */
    @media (max-width: 1200px) {
      .ai-dashboard {
        grid-template-columns: 1fr;
      }
      
      .ai-sidebar {
        display: none;
      }
    }
    
    @media (max-width: 768px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      
      .chart-container {
        height: 300px;
      }
      
      .dashboard-header h2 {
        font-size: 2.2rem;
      }
      
      header h1 {
        font-size: 2.5rem;
      }
      
      .ai-assistant-chat {
        width: 320px;
        height: 500px;
      }
    }
    
    @media (max-width: 480px) {
      .dashboard-controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .time-filter, .dashboard-export {
        width: 100%;
        flex-wrap: wrap;
      }
    }
    
    /* Animation Enhancements */
    @keyframes float3d {
      0%, 100% { transform: translateY(0) rotateX(0deg) rotateY(0deg); }
      25% { transform: translateY(-20px) rotateX(5deg) rotateY(5deg); }
      50% { transform: translateY(0) rotateX(10deg) rotateY(-5deg); }
      75% { transform: translateY(-10px) rotateX(-5deg) rotateY(10deg); }
    }
    
    /* Loading Spinner */
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(74, 144, 226, 0.2);
      border-top: 4px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Notification Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--card-bg);
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .toast.show {
      opacity: 1;
      bottom: 30px;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--danger);
    }
    
    /* Tooltip */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: var(--card-bg);
      color: var(--text);
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      box-shadow: var(--shadow);
      border: 1px solid var(--glass-border);
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <div id="vanta-bg"></div>
  
  <!-- AI Assistant Floating Button -->
  <div class="ai-assistant">
    <button class="ai-assistant-btn" id="aiAssistantBtn">
      <i class="fas fa-robot"></i>
    </button>
    <div class="ai-assistant-chat" id="aiAssistantChat">
      <div class="ai-assistant-header">
        <i class="fas fa-robot"></i>
        <h3>Analytics AI Assistant</h3>
      </div>
      <div class="ai-assistant-messages" id="aiMessages">
        <div class="ai-message ai-message-bot">
          <p>Hello Dharsan! I'm your AI assistant. How can I help you with your analytics needs today?</p>
        </div>
      </div>
      <div class="ai-assistant-input">
        <input type="text" id="aiInput" placeholder="Ask me about analytics, predictions...">
        <button id="aiSendBtn"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
  </div>
  
  <!-- Notification Toast -->
  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage">Success!</span>
  </div>
  
  <header>
    <div class="header-content">
      <h1><span class="title-3d">DHARSAN KUMAR P</span></h1>
      <p class="subtitle">AI-Powered Business & Data Analytics Expert</p>
      
      <div class="social-links">
        <a href="https://www.linkedin.com/in/dk---" class="social-link" target="_blank">
          <i class="fab fa-linkedin"></i>
        </a>
        <a href="#" class="social-link">
          <i class="fab fa-github"></i>
        </a>
        <a href="#" class="social-link">
          <i class="fab fa-twitter"></i>
        </a>
      </div>
    </div>
  </header>
  
  <main>
    <!-- AI Dashboard Section -->
    <section class="ai-dashboard" id="ai-dashboard">
      <div class="ai-sidebar">
        <div class="data-upload">
          <h3><i class="fas fa-cloud-upload-alt"></i> Data Upload</h3>
          <div class="upload-area" id="uploadArea">
            <i class="fas fa-file-excel"></i>
            <p>Drag & Drop Excel files here</p>
            <p>or</p>
            <button class="btn" id="browseFiles">Browse Files</button>
            <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
          </div>
          <div class="glass-card">
            <h4>Recent Files</h4>
            <ul id="recentFiles">
              <li>No recent files</li>
            </ul>
          </div>
        </div>
        
        <div class="glass-card">
          <h4><i class="fas fa-sliders-h"></i> Dashboard Controls</h4>
          <div class="form-group">
            <label for="dashboardTheme">Theme</label>
            <select id="dashboardTheme" class="form-control">
              <option value="light">Light</option>
              <option value="dark">Dark</option>
              <option value="system">System</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="chartType">Default Chart Type</label>
            <select id="chartType" class="form-control">
              <option value="line">Line Chart</option>
              <option value="bar">Bar Chart</option>
              <option value="pie">Pie Chart</option>
              <option value="scatter">Scatter Plot</option>
            </select>
          </div>
          
          <button class="btn" id="resetDashboard">
            <i class="fas fa-redo"></i> Reset Dashboard
          </button>
        </div>
      </div>
      
      <div class="ai-main">
        <div class="dashboard-header">
          <h2>AI-Powered Business Analytics</h2>
          <p>Interactive dashboard with automated insights generation from your data</p>
        </div>
        
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <h3><i class="fas fa-chart-line"></i> Automated Data Analysis</h3>
            <div class="chart-container" id="auto-analysis-chart">
              <div class="spinner" id="analysisSpinner"></div>
              <p id="analysisPlaceholder">Upload data to generate automated analysis</p>
            </div>
            <div class="kpi-container" id="analysisKpis">
              <!-- Auto-generated KPIs will appear here -->
            </div>
            <div class="dashboard-controls">
              <div class="time-filter">
                <button class="active">Overall</button>
                <button>Trends</button>
                <button>Outliers</button>
                <button>Patterns</button>
              </div>
              <div class="dashboard-export">
                <button id="exportAnalysis"><i class="fas fa-download"></i> Export</button>
                <button id="shareAnalysis"><i class="fas fa-share-alt"></i> Share</button>
              </div>
            </div>
          </div>
          
          <div class="dashboard-card">
            <h3><i class="fas fa-brain"></i> AI Insights</h3>
            <div id="aiInsights">
              <div class="glass-card">
                <h4><i class="fas fa-lightbulb"></i> Key Findings</h4>
                <ul id="keyFindings">
                  <li>Upload data to generate AI-powered insights</li>
                </ul>
              </div>
              <div class="glass-card">
                <h4><i class="fas fa-chart-bar"></i> Recommended Visualizations</h4>
                <div id="recommendedCharts">
                  <p>Data-driven chart recommendations will appear here</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="dashboard-card">
            <h3><i class="fas fa-crystal-ball"></i> Predictive Analytics</h3>
            <div class="chart-container" id="predictive-chart">
              <div class="spinner" id="predictiveSpinner"></div>
              <p id="predictivePlaceholder">Enable predictive analytics on your data</p>
            </div>
            <div class="dashboard-controls">
              <div class="time-filter">
                <button class="active" data-model="linear">Linear</button>
                <button data-model="neural">Neural Net</button>
                <button data-model="time">Time Series</button>
                <button data-model="ensemble">Ensemble</button>
              </div>
              <div class="dashboard-export">
                <button id="runPrediction"><i class="fas fa-play"></i> Run Prediction</button>
              </div>
            </div>
            <div class="prediction-result" id="predictionResult">
              <!-- Prediction results will appear here -->
            </div>
          </div>
          
          <div class="dashboard-card">
            <h3><i class="fas fa-table"></i> Data Preview</h3>
            <div id="dataPreview">
              <p>Uploaded data will appear here</p>
            </div>
            <div class="dashboard-controls">
              <div class="dashboard-export">
                <button id="refreshData"><i class="fas fa-sync-alt"></i> Refresh</button>
                <button id="cleanData"><i class="fas fa-broom"></i> Clean Data</button>
                <button id="transformData"><i class="fas fa-magic"></i> Transform</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Traditional Portfolio Sections -->
    <section id="about" class="section">
      <div class="container">
        <h2>About Me</h2>
        <div class="glass-card">
          <p>I'm Dharsan Kumar P, a passionate Business and Data Analytics professional with expertise in transforming complex data into actionable insights. My approach combines cutting-edge AI technologies with strategic business thinking to drive growth and innovation.</p>
          <p>With experience in predictive modeling, data visualization, and business intelligence, I help organizations make data-driven decisions that impact their bottom line.</p>
        </div>
      </div>
    </section>
    
    <section id="skills" class="section">
      <div class="container">
        <h2>AI & Analytics Skills</h2>
        <div class="skills-grid">
          <div class="glass-card">
            <h3><i class="fas fa-brain"></i> Machine Learning</h3>
            <div class="skill-level">
              <div class="skill-bar" style="width: 90%; background: linear-gradient(90deg, var(--primary), var(--accent));"></div>
            </div>
          </div>
          <div class="glass-card">
            <h3><i class="fas fa-chart-pie"></i> Data Visualization</h3>
            <div class="skill-level">
              <div class="skill-bar" style="width: 95%; background: linear-gradient(90deg, var(--primary), var(--accent));"></div>
            </div>
          </div>
          <div class="glass-card">
            <h3><i class="fas fa-database"></i> SQL & NoSQL</h3>
            <div class="skill-level">
              <div class="skill-bar" style="width: 85%; background: linear-gradient(90deg, var(--primary), var(--accent));"></div>
            </div>
          </div>
          <div class="glass-card">
            <h3><i class="fab fa-python"></i> Python</h3>
            <div class="skill-level">
              <div class="skill-bar" style="width: 88%; background: linear-gradient(90deg, var(--primary), var(--accent));"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <section id="projects" class="section">
      <div class="container">
        <h2>AI-Enhanced Projects</h2>
        <div class="projects-grid">
          <div class="glass-card">
            <h3><i class="fas fa-chart-line"></i> Predictive Sales Dashboard</h3>
            <p>AI-powered sales forecasting tool that predicts future sales with 92% accuracy using time series analysis and machine learning.</p>
            <button class="btn">View Case Study</button>
          </div>
          <div class="glass-card">
            <h3><i class="fas fa-shopping-cart"></i> Customer Segmentation Model</h3>
            <p>Implemented clustering algorithms to segment customers into distinct groups for targeted marketing campaigns.</p>
            <button class="btn">View Case Study</button>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <footer>
    <div class="container">
      <p>© 2025 Dharsan Kumar P - AI-Powered Business & Data Analytics </p>
      <div class="social-links">
        <a href="https://www.linkedin.com/in/dk---" target="_blank"><i class="fab fa-linkedin"></i></a>
        <a href="#"><i class="fab fa-github"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
      </div>
    </div>
  </footer>

  <script>
    // Initialize Vanta.js background with a more professional NET effect
    VANTA.NET({
      el: "#vanta-bg",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200.00,
      minWidth: 200.00,
      scale: 1.00,
      scaleMobile: 1.00,
      color: 0x4b8fe2,
      backgroundColor: 0xf8f9fa,
      points: 12.00,
      maxDistance: 22.00,
      spacing: 18.00
    });
    
    // Global variables for data storage
    let uploadedData = null;
    let currentCharts = {};
    
    // Initialize all functionality when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize theme toggle
      const themeToggle = document.createElement('div');
      themeToggle.className = 'theme-toggle';
      themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
      themeToggle.style.position = 'fixed';
      themeToggle.style.top = '20px';
      themeToggle.style.right = '20px';
      themeToggle.style.zIndex = '1000';
      themeToggle.style.background = 'var(--glass)';
      themeToggle.style.width = '40px';
      themeToggle.style.height = '40px';
      themeToggle.style.borderRadius = '50%';
      themeToggle.style.display = 'flex';
      themeToggle.style.alignItems = 'center';
      themeToggle.style.justifyContent = 'center';
      themeToggle.style.cursor = 'pointer';
      themeToggle.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
      document.body.appendChild(themeToggle);
      
      themeToggle.addEventListener('click', () => {
        document.body.setAttribute('data-theme', 
          document.body.getAttribute('data-theme') === 'dark' ? '' : 'dark');
        
        if (document.body.getAttribute('data-theme') === 'dark') {
          themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
          VANTA.NET({
            el: "#vanta-bg",
            color: 0x6c8cff,
            backgroundColor: 0x121212
          });
        } else {
          themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
          VANTA.NET({
            el: "#vanta-bg",
            color: 0x4b8fe2,
            backgroundColor: 0xf8f9fa
          });
        }
        
        // Re-render charts with new theme
        renderAllCharts();
      });
      
      // File upload functionality
      const uploadArea = document.getElementById('uploadArea');
      const fileInput = document.getElementById('fileInput');
      const browseFiles = document.getElementById('browseFiles');
      
      // Handle drag and drop
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'var(--accent)';
        uploadArea.style.backgroundColor = 'rgba(74, 144, 226, 0.1)';
      });
      
      uploadArea.addEventListener('dragleave', () => {
        uploadArea.style.borderColor = 'var(--glass-border)';
        uploadArea.style.backgroundColor = 'transparent';
      });
      
      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = 'var(--glass-border)';
        uploadArea.style.backgroundColor = 'transparent';
        
        if (e.dataTransfer.files.length) {
          fileInput.files = e.dataTransfer.files;
          handleFileUpload(e.dataTransfer.files[0]);
        }
      });
      
      browseFiles.addEventListener('click', () => {
        fileInput.click();
      });
      
      fileInput.addEventListener('change', () => {
        if (fileInput.files.length) {
          handleFileUpload(fileInput.files[0]);
        }
      });
      
      // Function to handle file upload and processing
      function handleFileUpload(file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
            
            // Get the first sheet
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // Convert to JSON
            uploadedData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
            
            // Show success message
            showToast('File uploaded successfully!', 'success');
            
            // Update recent files list
            updateRecentFiles(file.name);
            
            // Process the data and update dashboard
            processUploadedData();
          } catch (error) {
            console.error('Error processing file:', error);
            showToast('Error processing file. Please try again.', 'error');
          }
        };
        
                reader.onerror = function() {
          showToast('Error reading file. Please try again.', 'error');
        };
        
        reader.readAsArrayBuffer(file);
      }
      
      // Function to process uploaded data and update dashboard
      function processUploadedData() {
        if (!uploadedData || uploadedData.length < 2) {
          showToast('No valid data found in the file.', 'error');
          return;
        }
        
        // Show loading spinners
        document.getElementById('analysisSpinner').style.display = 'block';
        document.getElementById('analysisPlaceholder').style.display = 'none';
        document.getElementById('predictiveSpinner').style.display = 'block';
        document.getElementById('predictivePlaceholder').style.display = 'none';
        
        // Extract headers and data rows
        const headers = uploadedData[0];
        const rows = uploadedData.slice(1);
        
        // Update data preview
        updateDataPreview(headers, rows);
        
        // Generate automated analysis after a short delay (simulating processing)
        setTimeout(() => {
          generateAutomatedAnalysis(headers, rows);
          generateAIInsights(headers, rows);
          
          // Hide spinners
          document.getElementById('analysisSpinner').style.display = 'none';
          document.getElementById('predictiveSpinner').style.display = 'none';
        }, 1500);
      }
      
      // Function to update data preview table
      function updateDataPreview(headers, rows) {
        const dataPreview = document.getElementById('dataPreview');
        dataPreview.innerHTML = '';
        
        // Create table element
        const table = document.createElement('table');
        table.className = 'data-table';
        table.style.width = '100%';
        table.style.borderCollapse = 'collapse';
        
        // Create header row
        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        
        headers.forEach(header => {
          const th = document.createElement('th');
          th.textContent = header;
          th.style.padding = '10px';
          th.style.borderBottom = '1px solid var(--glass-border)';
          th.style.textAlign = 'left';
          headerRow.appendChild(th);
        });
        
        thead.appendChild(headerRow);
        table.appendChild(thead);
        
        // Create body with first 5 rows
        const tbody = document.createElement('tbody');
        const displayRows = rows.slice(0, 5);
        
        displayRows.forEach(row => {
          const tr = document.createElement('tr');
          
          row.forEach((cell, index) => {
            const td = document.createElement('td');
            td.textContent = cell;
            td.style.padding = '10px';
            td.style.borderBottom = '1px solid var(--glass-border)';
            tr.appendChild(td);
          });
          
          tbody.appendChild(tr);
        });
        
        table.appendChild(tbody);
        dataPreview.appendChild(table);
        
        // Add row count info
        const info = document.createElement('p');
        info.textContent = `Showing 5 of ${rows.length} rows.`;
        info.style.marginTop = '10px';
        info.style.fontSize = '0.9em';
        info.style.opacity = '0.8';
        dataPreview.appendChild(info);
      }
      
      // Function to generate automated analysis
      function generateAutomatedAnalysis(headers, rows) {
        // This would be replaced with actual analysis in a real implementation
        const analysisChart = document.getElementById('auto-analysis-chart');
        
        // Initialize chart (using ECharts in this example)
        const chart = echarts.init(analysisChart);
        
        // Sample chart data - in a real app this would come from actual analysis
        const chartData = {
          dimensions: headers.slice(0, 3),
          source: rows.slice(0, 10).map(row => ({
            [headers[0]]: row[0],
            [headers[1]]: row[1],
            [headers[2]]: row[2]
          }))
        };
        
        const option = {
          dataset: {
            dimensions: chartData.dimensions,
            source: chartData.source
          },
          tooltip: {
            trigger: 'axis',
            axisPointer: {
              type: 'shadow'
            }
          },
          legend: {
            data: chartData.dimensions.slice(1)
          },
          xAxis: {
            type: 'category',
            axisLabel: {
              rotate: 30
            }
          },
          yAxis: {},
          series: chartData.dimensions.slice(1).map(dim => ({
            type: 'bar',
            name: dim
          })),
          backgroundColor: 'transparent'
        };
        
        chart.setOption(option);
        currentCharts.analysis = chart;
        
        // Generate sample KPIs
        const kpiContainer = document.getElementById('analysisKpis');
        kpiContainer.innerHTML = '';
        
        const kpis = [
          { label: 'Total Records', value: rows.length, icon: 'fas fa-database' },
          { label: 'Columns', value: headers.length, icon: 'fas fa-columns' },
          { label: 'Numeric Columns', value: Math.min(5, headers.length), icon: 'fas fa-sort-numeric-up' },
          { label: 'Date Columns', value: 1, icon: 'fas fa-calendar-alt' }
        ];
        
        kpis.forEach(kpi => {
          const kpiCard = document.createElement('div');
          kpiCard.className = 'kpi-card';
          kpiCard.innerHTML = `
            <div class="kpi-value">${kpi.value}</div>
            <div class="kpi-label">${kpi.label}</div>
            <i class="${kpi.icon}" style="margin-top: 10px; color: var(--accent);"></i>
          `;
          kpiContainer.appendChild(kpiCard);
        });
        
        // Add resize event listener
        window.addEventListener('resize', function() {
          chart.resize();
        });
      }
      
      // Function to generate AI insights
      function generateAIInsights(headers, rows) {
        const keyFindings = document.getElementById('keyFindings');
        keyFindings.innerHTML = '';
        
        // Sample insights - in a real app these would come from actual analysis
        const insights = [
          `Strong correlation detected between "${headers[1]}" and "${headers[2]}" (r=0.87)`,
          `Seasonal patterns identified in "${headers[3]}" with quarterly peaks`,
          `Outliers detected in "${headers[4]}" - recommend investigation`,
          `Data quality score: 92/100 - minor missing values in "${headers[5]}"`
        ];
        
        insights.forEach(insight => {
          const li = document.createElement('li');
          li.textContent = insight;
          li.style.marginBottom = '8px';
          li.style.display = 'flex';
          li.style.alignItems = 'center';
          li.style.gap = '8px';
          
          const icon = document.createElement('i');
          icon.className = 'fas fa-lightbulb';
          icon.style.color = 'var(--accent)';
          
          li.prepend(icon);
          keyFindings.appendChild(li);
        });
        
        // Recommended visualizations
        const recommendedCharts = document.getElementById('recommendedCharts');
        recommendedCharts.innerHTML = '';
        
        const recommendations = [
          { type: 'Scatter Plot', desc: `Show relationship between "${headers[1]}" and "${headers[2]}"` },
          { type: 'Time Series', desc: `Track trends in "${headers[3]}" over time` },
          { type: 'Heatmap', desc: 'Visualize correlation matrix' }
        ];
        
        recommendations.forEach(rec => {
          const card = document.createElement('div');
          card.className = 'glass-card';
          card.style.marginBottom = '10px';
          card.style.padding = '10px';
          card.innerHTML = `
            <h5 style="margin: 0 0 5px 0;"><i class="fas fa-chart-${rec.type.includes('Scatter') ? 'scatter' : rec.type.includes('Time') ? 'line' : 'bar'}"></i> ${rec.type}</h5>
            <p style="margin: 0; font-size: 0.9em;">${rec.desc}</p>
          `;
          recommendedCharts.appendChild(card);
        });
      }
      
      // Function to update recent files list
      function updateRecentFiles(filename) {
        const recentFiles = document.getElementById('recentFiles');
        
        // Create new list item
        const li = document.createElement('li');
        li.style.display = 'flex';
        li.style.alignItems = 'center';
        li.style.justifyContent = 'space-between';
        li.style.padding = '8px 0';
        li.style.borderBottom = '1px solid var(--glass-border)';
        
        li.innerHTML = `
          <span><i class="fas fa-file-excel" style="color: var(--success); margin-right: 8px;"></i>${filename}</span>
          <i class="fas fa-times" style="cursor: pointer; color: var(--danger);"></i>
        `;
        
        // If "No recent files" message exists, remove it
        if (recentFiles.firstChild.textContent === 'No recent files') {
          recentFiles.innerHTML = '';
        }
        
        // Add new file to top of list
        recentFiles.insertBefore(li, recentFiles.firstChild);
        
        // Add click handler to remove button
        li.querySelector('.fa-times').addEventListener('click', (e) => {
          e.stopPropagation();
          li.remove();
          
          if (recentFiles.children.length === 0) {
            const emptyMsg = document.createElement('li');
            emptyMsg.textContent = 'No recent files';
            recentFiles.appendChild(emptyMsg);
          }
        });
      }
      
      // Function to show toast notifications
      function showToast(message, type) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        
        toast.className = `toast ${type}`;
        toastMessage.textContent = message;
        
        // Show toast
        toast.classList.add('show');
        
        // Hide after 3 seconds
        setTimeout(() => {
          toast.classList.remove('show');
        }, 3000);
      }
      
      // Function to re-render all charts when theme changes
      function renderAllCharts() {
        if (currentCharts.analysis) {
          currentCharts.analysis.dispose();
          generateAutomatedAnalysis(uploadedData[0], uploadedData.slice(1));
        }
      }
      
      // AI Assistant functionality
      const aiAssistantBtn = document.getElementById('aiAssistantBtn');
      const aiAssistantChat = document.getElementById('aiAssistantChat');
      const aiSendBtn = document.getElementById('aiSendBtn');
      const aiInput = document.getElementById('aiInput');
      const aiMessages = document.getElementById('aiMessages');
      
      aiAssistantBtn.addEventListener('click', () => {
        aiAssistantChat.classList.toggle('active');
      });
      
      aiSendBtn.addEventListener('click', sendMessage);
      aiInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });
      
      function sendMessage() {
        const message = aiInput.value.trim();
        if (!message) return;
        
        // Add user message
        addMessage(message, 'user');
        aiInput.value = '';
        
        // Simulate AI response after a delay
        setTimeout(() => {
          const responses = [
            "Based on your data, I've detected some interesting trends in the sales figures.",
            "The correlation between these two variables suggests a strong relationship worth investigating further.",
            "I recommend creating a time series analysis to better understand the seasonal patterns.",
            "There appears to be some outliers in the dataset that might need your attention.",
            "Would you like me to generate a predictive model for this data?"
          ];
          
          const randomResponse = responses[Math.floor(Math.random() * responses.length)];
          addMessage(randomResponse, 'bot');
        }, 1000 + Math.random() * 2000);
      }
      
      function addMessage(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `ai-message ai-message-${sender}`;
        messageDiv.innerHTML = `<p>${text}</p>`;
        aiMessages.appendChild(messageDiv);
        aiMessages.scrollTop = aiMessages.scrollHeight;
      }
      
      // Predictive analytics button handlers
      document.getElementById('runPrediction').addEventListener('click', () => {
        if (!uploadedData) {
          showToast('Please upload data first', 'error');
          return;
        }
        
        const predictiveChart = document.getElementById('predictive-chart');
        predictiveChart.innerHTML = '<div class="spinner" id="predictiveSpinner"></div>';
        
        // Simulate prediction after delay
        setTimeout(() => {
          document.getElementById('predictiveSpinner').style.display = 'none';
          
          // Initialize prediction chart
          const chart = echarts.init(predictiveChart);
          
          // Sample prediction data
          const option = {
            xAxis: {
              type: 'category',
              data: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
              type: 'value'
            },
            series: [
              {
                data: [120, 200, 150, 80, 70, 110, 130, 180, 210, 190, 250, 300],
                type: 'line',
                smooth: true,
                name: 'Actual'
              },
              {
                data: [null, null, null, null, null, null, null, null, 210, 195, 260, 320],
                type: 'line',
                smooth: true,
                name: 'Predicted',
                lineStyle: {
                  type: 'dashed'
                }
              }
            ],
            tooltip: {
              trigger: 'axis'
            },
            legend: {
              data: ['Actual', 'Predicted']
            },
            backgroundColor: 'transparent'
          };
          
          chart.setOption(option);
          currentCharts.predictive = chart;
          
          // Update prediction results
          const predictionResult = document.getElementById('predictionResult');
          predictionResult.innerHTML = `
            <div class="glass-card" style="margin-top: 20px;">
              <h4><i class="fas fa-chart-line"></i> Prediction Results</h4>
              <p>Forecast for next quarter shows <strong>15% growth</strong> with 88% confidence.</p>
              <p>Key drivers: ${uploadedData[0][1]}, ${uploadedData[0][2]}</p>
            </div>
          `;
          
          // Add resize event listener
          window.addEventListener('resize', function() {
            chart.resize();
          });
        }, 2000);
      });
      
      // Data cleaning button
      document.getElementById('cleanData').addEventListener('click', () => {
        if (!uploadedData) {
          showToast('Please upload data first', 'error');
          return;
        }
        
        showToast('Data cleaning in progress...', 'success');
        
        // Simulate data cleaning
        setTimeout(() => {
          showToast('Data cleaned successfully! 5 missing values filled, 2 duplicates removed.', 'success');
          
          // In a real app, this would update the actual data
          updateDataPreview(uploadedData[0], uploadedData.slice(1));
        }, 1500);
      });
      
      // Data transformation button
      document.getElementById('transformData').addEventListener('click', () => {
        if (!uploadedData) {
          showToast('Please upload data first', 'error');
          return;
        }
        
        showToast('Applying transformations...', 'success');
        
        // Simulate data transformation
        setTimeout(() => {
          showToast('Data transformed: 3 columns normalized, 2 new features created.', 'success');
          
          // In a real app, this would update the actual data
          updateDataPreview(uploadedData[0], uploadedData.slice(1));
        }, 1500);
      });
      
      // Export analysis button
      document.getElementById('exportAnalysis').addEventListener('click', () => {
        if (!uploadedData) {
          showToast('Please upload data first', 'error');
          return;
        }
        
        // Create a new workbook
        const wb = XLSX.utils.book_new();
        
        // Convert data to worksheet
        const ws = XLSX.utils.aoa_to_sheet(uploadedData);
        
        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(wb, ws, "Analysis");
        
        // Generate Excel file and download
        XLSX.writeFile(wb, "data_analysis.xlsx");
        showToast('Analysis exported to Excel', 'success');
      });
      
      // Reset dashboard button
      document.getElementById('resetDashboard').addEventListener('click', () => {
        if (confirm('Are you sure you want to reset the dashboard? This will clear all current data.')) {
          // Clear uploaded data
          uploadedData = null;
          fileInput.value = '';
          
          // Reset UI elements
          document.getElementById('analysisPlaceholder').style.display = 'block';
          document.getElementById('analysisSpinner').style.display = 'none';
          document.getElementById('predictivePlaceholder').style.display = 'block';
          document.getElementById('predictiveSpinner').style.display = 'none';
          document.getElementById('dataPreview').innerHTML = '<p>Uploaded data will appear here</p>';
          document.getElementById('keyFindings').innerHTML = '<li>Upload data to generate AI-powered insights</li>';
          document.getElementById('recommendedCharts').innerHTML = '<p>Data-driven chart recommendations will appear here</p>';
          document.getElementById('analysisKpis').innerHTML = '';
          document.getElementById('predictionResult').innerHTML = '';
          
          // Dispose of any existing charts
          Object.values(currentCharts).forEach(chart => {
            if (chart && chart.dispose) chart.dispose();
          });
          currentCharts = {};
          
          showToast('Dashboard reset successfully', 'success');
        }
      });
    });
  </script>
</body>
</html>
